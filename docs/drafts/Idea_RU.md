# Сервис «DeathManSwitch» — схема «Вопросы + Timelock»

## Цель
Передать конфиденциальные данные (seed‑фразы криптовалют, номера счетов, пароли к почте и т. д.) доверенным людям, если владелец перестал выходить на связь.

## Основные сущности
| Объект | Описание |
|--------|----------|
| **Секрет** | Файл/текст, шифруемый случайным `DEK` (AES‑256‑GCM). |
| **Вопрос** | Персональный вопрос, ответ знают только владелец и получатель. |
| **Timelock‑обёртка** | Шифрование вопросов при помощи drand `tlock`; раскрывается через *X* дней отсутствия владельца. |

## Алгоритм
1. Владелец создаёт *N* (например 10) вопросов для адресата; ответы вводятся сразу.
2. Случайный `DEK` → шифрует секрет.
3. `DEK` делится схемой Шамира k‑of‑N (k = ceil(⅔ N)).
4. Каждый фрагмент `S_i` шифруется ключом `K_i = Argon2id(answer_i, salt_i)`.
5. JSON `[ {q,salt,C_i}, … ]` шифруется через `tlock` на раунд `R_0 = now + X дней`.
6. При каждом «I’m alive»:
   * вычисляется новый `R_next = now + X дней`;
   * вопросы перешифровываются на `R_next`.
7. Если владелец пропал → по достижении раунда `R_last` вопросы раскрываются.
8. Пользователь вводит ответы в веб‑форму. Любые k правильных ответов восстанавливают `DEK` и расшифровывают секрет.
9. Если k не набрано — секрет остаётся недоступен.

## Компромисс
Snapshot всего сервера даёт злоумышленнику шанс перебрать ответы после раскрытия вопросов. Риск принят осознанно, так как:
* вопросы персональные и имеют высокую энтропию;
* раскрываются только вопросы, а не сами данные;
* отсутствие внешнего KMS упрощает инфраструктуру и исключает SPOF.

