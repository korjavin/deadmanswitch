version: "2"

run:
  tests: true

linters:
  default: none
  enable:
    # Core linters
    - errcheck      # Check for unchecked errors
    - govet         # Vet examines Go source code
    - ineffassign   # Detect ineffectual assignments
    - staticcheck   # Static analysis (includes gosimple)
    - unused        # Find unused code

    # Additional recommended linters
    - bodyclose     # Check HTTP response body is closed
    - copyloopvar   # Find places where loop variables are copied
    - dogsled       # Find assignments with too many blank identifiers
    - dupl          # Find code duplication
    - exhaustive    # Check exhaustiveness of enum switch statements
    - goconst       # Find repeated strings that could be constants
    - gocritic      # Comprehensive Go linter
    - gocyclo       # Compute cyclomatic complexity
    - godot         # Check comments end in period
    - gosec         # Security checker
    - misspell      # Find misspelled words
    - nakedret      # Find naked returns in large functions
    - nolintlint    # Check nolint directives
    - prealloc      # Find slice declarations that could be preallocated
    - revive        # Fast, configurable, extensible, flexible, and beautiful linter
    - rowserrcheck  # Check sql.Rows.Err is checked
    - sqlclosecheck # Check sql.Rows/sql.Stmt are closed
    - unconvert     # Remove unnecessary type conversions
    - unparam       # Find unused function parameters

  settings:
    errcheck:
      check-type-assertions: true
      check-blank: true

    gocyclo:
      min-complexity: 15

    dupl:
      threshold: 100

    goconst:
      min-len: 3
      min-occurrences: 3

    misspell:
      locale: US

    gosec:
      excludes:
        - G404 # Use of weak random number generator - we use crypto/rand where needed

    revive:
      rules:
        - name: exported
          disabled: true # Don't require doc comments on all exports
        - name: package-comments
          disabled: true

  exclusions:
    generated: lax
    presets:
      - comments
      - common-false-positives
      - legacy
      - std-error-handling
    paths:
      - third_party$
      - builtin$
      - examples$
      - _test\.go$

issues:
  max-same-issues: 0

formatters:
  enable:
    - gofmt
    - goimports
  exclusions:
    generated: lax
    paths:
      - third_party$
      - builtin$
      - examples$
